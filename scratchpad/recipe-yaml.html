<html>
<head>
<link href="https://fonts.googleapis.com/css?family=Fira+Sans:400,400i,700,700i,900" rel="stylesheet">
<style>
:root {
  font-family: 'Fira Sans', sans-serif;
}
body {
  background: #f8f8f8;
}
</style>
</head>
<body>

<div id="recipe"></div>
<script>
window.onload = function () {
  const r = {
    name: 'Sambar',
    desc: 'Sambar is a dish',
    category: 'Mains',
    tags: ['savoury', 'daily'],
    images: [],
    prep_time: '1h 30m',
    cook_time: '00 : 30',
    serves: 3,
    ingredients: {
      note: 'Some note here',
      Main: [
        {'Tur dal': '2 tsp'},
        {'Chillies (green)': 2},
        'Salt',
      ],
      Vegetables: [
        {Onion: 3},
        'Potato',
      ],
      Garnish: [
        {coriander: 3},
        'parsley',
      ]
    },
    instructions: '**gfm** content',
    instructions_: [
      'step 1',
      'step 2',
      'step 3',
    ],
  }
  document.getElementById('recipe').innerHTML = Recipe(r)


  function Ingredient(i) {
    if (typeof i === 'string') return `<span class="ingr-name">${i}</span>`
    if (typeof i === 'object' && i !== null && !Array.isArray(i)) {
      const [name, quantity] = Object.entries(i)[0]
      return `<span class="ingr-name">${name}</span><span class="ingr-quant">${quantity}</span>`
      // if (typeof val === 'string' || typeof val === 'number') {}
    }
    // if (Array.isArray(i)) return `<li>array todo</li>`
    return `<span></span>`
  }

  function Instructions(i) {
    if (typeof i === 'string') return i // use markdown
  }

  function Recipe(r) {
    return `
      <h1>${r.name}</h1>
      <p>${r.desc}</p>
      <div><b>Category:</b> Mains</div>
      <div><b>Tags:</b> ${r.tags.map(t => `<span>${t}</span>`).join(' ')}</div>
      <div><b>Prep time:</b> ${r.prep_time}</div>
      <div><b>Cook time:</b> ${r.cook_time}</div>
      <div><b>Serves:</b> ${r.serves}</div>
      <hr />
      <section class="ingredients">
        <h2>Ingredients</h2>
        ${Object.entries(r.ingredients).map(([key, val]) => {
          if (typeof val === 'string') return `<div><b>${key}:</b> ${val}</div>`
          return `
            <div class="ingr-group">
              <div class="ingr-group-name"><b>${key}</b></div>
              <ul>
                ${val.map(i => `<li>${Ingredient(i)}</li>`).join('')}
              </ul>
            </div>
          `
        }).join('')}
      </section>
      <hr />
      <section class="instructions">
        ${Instructions(r.instructions)}
      </section>
    `
  }
}
</script>
</body>
</html>